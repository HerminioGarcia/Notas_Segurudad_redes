# b00tl3gRSA2

## Objetivo 
En RSA, d es mucho más grande que e, ¿por qué no usamos d para cifrar en lugar de e? Conéctese con `nc jupiter.challenges.picoctf.org 18243`.

## Solución
revisamos el archivo y nos damos cuenta de que no podemos travajar con mod ya que es muy pequeño asi que procedemos a usar lo sigiente 

``` shell
c - texto cifrado
m - mensajo en texto plano (lo que se va encriptar)
p - primo 1
q - primo 2
n - modulo
tn - totient n (euler)
e - exponente (llave publica, suele ser 216 + 1=65537 )
d - llave privada

// operaciones necesarias

n = p * q
tn = (p-1)*(q-1)
d = e mod inv tn / python -> inverse(e,tn)

Encriptar
c = m^e mod n / python -> pow(m,e,n)

Desencriptar
m = c^d mod n / python -> pow(c,d,n)

c=m^e mod n
c=m^3
m=3 raiz c

┌──(mino20㉿kali)-[~/Descargas/miniRSA]
└─$ nc jupiter.challenges.picoctf.org 18243
c: 24013742558040246389389254559337436292156224638828138673460793941016149525390036953823743431145614579767077922796547071085891228036033745140487163117083060165968516116063964911694568568773895307973417949606342173311818770242844323155200018985982874072753981281676045336591752999474038823932205719662084739179
n: 71304506681169425428312422089662144315018071538129058194887638106074611539182486439569181019902336501138399219401954526600175003243576095032122614218438366839995882962926034943097177960288490318047487102569447576890778255966480153478937510534667352086526378594927556903822179943059360650155195142756592493527
e: 18786562046839990675048760123627817048192884038770075649650195266453916374674824806628943172111229448481876486891581073451717682851012839051522974498524115948393236984589560197007841787174954544256045885488146842304745443670510662836577879175949094593752105845508573130544455398461383776147829432874434063193
 
```

Antes de pasar a la solucion en python, debemos saber que este reto tiene una seguridad extra, asi que, cambiambos 'e' por 'd', y a 'e' le asignamos como valor predeterminado 65537. Cuando usemos la formula para desencriptar vamos a intercambiar tambien la 'd' por la 'e', de modo que quede asi: m=pow(c,e,n).

``` shell
//pyton
┌──(mino20㉿kali)-[~/Descargas/miniRSA]
└─$ python
Python 3.10.5 (main, Jun  8 2022, 09:26:22) [GCC 11.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> c=24013742558040246389389254559337436292156224638828138673460793941016149525390036953823743431145614579767077922796547071085891228036033745140487163117083060165968516116063964911694568568773895307973417949606342173311818770242844323155200018985982874072753981281676045336591752999474038823932205719662084739179
>>> n=71304506681169425428312422089662144315018071538129058194887638106074611539182486439569181019902336501138399219401954526600175003243576095032122614218438366839995882962926034943097177960288490318047487102569447576890778255966480153478937510534667352086526378594927556903822179943059360650155195142756592493527
>>> d=18786562046839990675048760123627817048192884038770075649650195266453916374674824806628943172111229448481876486891581073451717682851012839051522974498524115948393236984589560197007841787174954544256045885488146842304745443670510662836577879175949094593752105845508573130544455398461383776147829432874434063193
>>> e=65537
>>> m=pow(c,d,n)
>>> m
28004089137275790818928006415228188519426270289685813544178652541186182329466563113511931910778223161712601783067409984901028965440139838519014941262977993881751727132565561634069202331671884376205513981180447347227928319335899877535489002384490236247369002072494640267955841659486325425958554538712944541660
>>> from Crypto.Util.number import long_to_bytes
>>> long_to_bytes(m)
>>> m=pow(c,e,n)
>>> long_to_bytes(m)
b'picoCTF{bad_1d3a5_4783252}'
>>
```

## Notas
[Tutorial](https://en.wikipedia.org/wiki/RSA_(cryptosystem)) RSA

¿Qué es e en general?

## Referencias
sin referencias.